<!doctype html>
<html><head><meta charset="utf-8"><title>Teacher</title>
<link rel="stylesheet" href="/css/style.css"></head><body>
<div class="container">
  <h2>Tableau Professeur</h2>
  <div class="panel">
    <h3>Créer un élève</h3>
    <input id="em" placeholder="email"/><input id="nm" placeholder="nom"/><input id="pw" placeholder="password (opt)"/>
    <button id="create">Créer</button>
    <p id="create_msg"></p>
  </div>

  <div class="panel">
    <h3>Projets</h3>
    <button id="refresh">Rafraîchir</button>
    <ul id="projects"></ul>
  </div>
</div>

<script>
  function authHeaders(){ return { 'Authorization':'Bearer ' + localStorage.getItem('token'), 'Content-Type':'application/json' }; }

  document.getElementById('create').onclick = async ()=>{
    const email = document.getElementById('em').value;
    const name = document.getElementById('nm').value;
    const password = document.getElementById('pw').value;
    const res = await fetch('/api/teacher/create_student', {method:'POST', headers: authHeaders(), body: JSON.stringify({email,name,password})});
    const j = await res.json();
    document.getElementById('create_msg').innerText = JSON.stringify(j);
  };

  document.getElementById('refresh').onclick = async ()=>{
    const res = await fetch('/api/projects', {headers: authHeaders()});
    const j = await res.json();
    const ul = document.getElementById('projects'); ul.innerHTML='';
    (j.projects || []).forEach(p=>{
      const li = document.createElement('li');
      li.innerText = p.name + ' — owner:' + (p.ownerId? (p.ownerId.name || p.ownerId.email) : p.ownerId);
      ul.appendChild(li);
    });
  };
</script>
</body></html>
