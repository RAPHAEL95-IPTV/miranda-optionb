<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Simulateur 3D ‚Äî Diagnostic</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body { margin:0; background:#222; color:white; font-family:Arial }
    #sim_container {
      width:100%;
      height:600px;
      background:#111;
      position:relative;
      border:4px solid red; /* DEBUG VISUEL */
    }
    #sim_logs {
      position:absolute;
      top:10px;
      left:10px;
      padding:6px;
      background:rgba(0,0,0,0.5);
      z-index:10;
      font-size:12px;
      border-radius:4px;
    }
  </style>
</head>

<body>
  <h2>Simulateur 3D ‚Äî Test complet</h2>
  <div id="sim_container">
    <div id="sim_logs">Initialisation‚Ä¶</div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r152/three.min.js"></script>

  <script>
    function slog(...msg){
      console.log(...msg);
      document.getElementById("sim_logs").textContent = msg.join(" ");
    }

    let scene, camera, renderer, cube;

    function init(){
      const cont = document.getElementById("sim_container");

      // üî• DEBUG : Affiche taille container
      slog("Taille container =", cont.clientWidth, "x", cont.clientHeight);

      if(cont.clientHeight === 0){
        slog("‚ùå PROBL√àME : hauteur container = 0 !");
        return;
      }

      scene = new THREE.Scene();

      camera = new THREE.PerspectiveCamera(
        60,
        cont.clientWidth / cont.clientHeight,
        0.1,
        1000
      );
      camera.position.set(3, 3, 3);
      camera.lookAt(0,0,0);

      renderer = new THREE.WebGLRenderer({ antialias:true });
      renderer.setSize(cont.clientWidth, cont.clientHeight);
      renderer.setClearColor(0x333333);

      // üî• DEBUG : Supprime tout puis ajoute canvas
      cont.innerHTML = '<div id="sim_logs"></div>';
      cont.appendChild(renderer.domElement);

      document.getElementById("sim_logs").textContent = "Canvas ajout√© ‚úî";

      // Test d‚Äôobjet 3D simple
      const geo = new THREE.BoxGeometry(1,1,1);
      const mat = new THREE.MeshBasicMaterial({ color:0xff0000 });
      cube = new THREE.Mesh(geo, mat);
      scene.add(cube);

      slog("Cube cr√©√© ‚úî");

      animate();
    }

    function animate(){
      requestAnimationFrame(animate);
      cube.rotation.y += 0.02;
      cube.rotation.x += 0.01;
      renderer.render(scene, camera);
    }

    window.addEventListener("resize", () => {
      const cont = document.getElementById("sim_container");
      camera.aspect = cont.clientWidth / cont.clientHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(cont.clientWidth, cont.clientHeight);
    });

    // Lancer init
    window.onload = init;
  </script>
</body>
</html>